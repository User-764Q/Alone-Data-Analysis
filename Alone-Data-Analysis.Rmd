---
title: "Alone Data Analysis"
output:
  html_document:
    df_print: paged
---

Alone has been on the History channel for 8 seasons and is one of my favorite shows. 

I wanted to look at the data behind it to see how long contestants last and why they leave.

I created the dataset my self by browsing and googling mostly wikipedia with some augmentation from other sites. 

I put the reasons for leaving in my own groups noting that this isn't an exact science, many people left due to a combination of not getting enough food and mental fatigue of not wanting to do it anymore. I decided which of those groups the contestant would be in by asking my self.. 'Yeah they feel pretty low right now but if the got a really good big meal would they stay?'

```{r}

library(tidyverse)
library(ggthemes)
 
# Reading in my custom data set 

als8 = read_tsv('data/SeasonTable/Contestants-Table 1.tsv') 


```

### Histogram 

Histagram of the week contestants left 

This shows that a bunch of people leave weeks 1 and 2 but it is a slow continuous drop off after that. 


```{r}

als8 = als8 %>%
  mutate(week_left = DayLeft %% 7)

als8 %>% 
  ggplot(aes(x = week_left)) + 
  geom_histogram(binwidth  = 1)

```

### Survival Curve

The same pattern is visible when looking at the data in a survival curve. 

Survival Curve

```{r}

Survival_table <- data.frame(Days = NULL, Contestants = NULL)

for (d in 0:max(als8$DayLeft)) {
  als_this <- als8 %>% 
    filter(DayLeft >= d)
  
  Survival_table = rbind(Survival_table, data.frame(Days = d, Contestants = length(als_this$ID)))
}

Survival_table = Survival_table %>%
  mutate(Percent_left = (Contestants / max(Contestants))*100)

Survival_table %>% 
  ggplot(aes(x=Days, y = Percent_left)) +
  geom_point() +
  theme_minimal()

Survival_rate_1_week = Survival_table %>% filter(Days == 7) %>% pull(Percent_left) %>% round(0)
Survival_rate_2_week = Survival_table %>% filter(Days == 14) %>% pull(Percent_left) %>% round(0)
Survival_rate_1_month = Survival_table %>% filter(Days == 7*4) %>% pull(Percent_left) %>% round(0)
Survival_rate_2_month = Survival_table %>% filter(Days == 7*4*2) %>% pull(Percent_left) %>% round(0)
Survival_rate_3_month = Survival_table %>% filter(Days == 7*4*3) %>% pull(Percent_left) %>% round(0)
  
```

### Survial by Season

Looking at the survival curves by season you can see the contestants lasting longer except for season 8, which was brutal. 

```{r}

Survival_table_season <- data.frame(Days = NULL, Contestants = NULL, Season = NULL)

for (s in unique(als8$Season)) 
{
  als8s <- als8 %>% filter(Season == s)
  
  for (d in 0:100)
    {
  als_this <- als8s %>% 
    filter(DayLeft >= d)
  Survival_table_season = rbind(Survival_table_season, 
                                data.frame(Days = d, 
                                           Contestants = length(als_this$ID), 
                                           Season = s))
  }}

Survival_table_season %>%
  mutate(Season = factor(Season)) %>%
  ggplot(aes(x = Days, y = Contestants, col = Season)) +
  geom_line() + 
  facet_wrap(~Season) +
  theme_minimal()


```

### Survival by location

Only two locations have had multiple seasons.

. Slave Lake 
. Vancouver Island 

Looking at the survival curves for these those locations to see which was harder. Slave lake definately had more staying potential and less people pulling out in the first week or two

```{r}

Seasons <- read_tsv(file.path('data','Seasons-Table 1.tsv'))

als_loc <- als8 %>%
  left_join(Seasons, by = c('Season' = 'SeasonNo')) %>%
  filter(Location  ==  'Vancouver Island' | 
         Location ==  'Slave Lake')

Survival_table_loc <- data.frame(Days = NULL, Contestants = NULL, Location = NULL)

for (l in unique(als_loc$Location)) {
  als_locl <- als_loc %>% filter(Location == l)
  for (d in 0:max(als_locl$DayLeft)) {
  als_this <- als_locl %>% 
    filter(DayLeft >= d)
  
  Survival_table_loc = rbind(Survival_table_loc, 
                             data.frame(Days = d, 
                                        Contestants = length(als_this$ID),
                             Location = l))
}}

Survival_table_loc = Survival_table_loc %>%
  mutate(Percent_left = (Contestants / max(Contestants))*100)

Survival_table_loc %>% 
  ggplot(aes(x=Days, 
             y = Percent_left, 
             group = Location, 
             colour = Location)) +
  geom_line() + 
  theme_minimal() + 
  labs(title = element_text('Alone Survival By Location'))

```

### Reason for Leaving 

Looking at reasons for leaving (my own custom groupings) more people left because they didn't want to do it any more vs starving out, with more accidents than I would have guessed. 

```{r}

als81 = als8 %>%
  mutate(ReasonForLeaving_fct = fct_infreq(als8$ReasonForLeaving)) %>%
  group_by(ReasonForLeaving_fct) %>%
  summarise(People = n()) %>%
  ungroup() 

als81 %>%
  ggplot(aes(x=ReasonForLeaving_fct, y = People)) + 
  geom_col() + 
  coord_flip() +
  theme_minimal()

```


e\### Reson By Location

Limiting it to Slave Lake and Vancouver Island 

```{r}

als_loc <- als_loc %>%
  mutate(ReasonForLeaving_fct = fct_infreq(als_loc$ReasonForLeaving)) %>%
  group_by(ReasonForLeaving_fct, Location) %>%
  summarise(People = n()) %>%
  ungroup() 

als_loc %>%
  ggplot(aes(x=ReasonForLeaving_fct, 
             y = People, 
             Col = Location, 
             fill = Location)) + 
  geom_col(position = 'dodge') + 
  coord_flip() +
  theme_minimal() + 
  labs(title = element_text('Reason Contenants Left By Location'))

```